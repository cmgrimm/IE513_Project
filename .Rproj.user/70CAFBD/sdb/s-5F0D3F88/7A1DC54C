{
    "collab_server" : "",
    "contents" : "\n# This is the server logic for a Shiny web application.\n# You can find out more about building applications with Shiny here:\n#\n# http://shiny.rstudio.com\n#\n\npackages <- c(\n  \"shiny\",\n  \"highcharter\"\n)\n\nipak <- function(pkg){\n  new.pkg <- pkg[!(pkg %in% installed.packages()[, \"Package\"])]\n  if (length(new.pkg)) \n    install.packages(new.pkg, dependencies = TRUE)\n  sapply(pkg, require, character.only = TRUE)\n}\n\nipak(packages)\n\n# Begin server ------------------------------------------------------------\n\nshinyServer(function(input, output) {\n\n  t_intervals <- reactive({ seq(1,input$t_max,1) })\n  t_instance <- reactive({ input$t_instance }) #time instance selected\n  \n  l_calculation <- reactive({\n    switch(input$l_fun,\n           \"f(t) = sin(t/4)+2\" = function(t) (sin(t/4)+2),\n           \"f(t) = t\" = function(t) t,\n           \"f(t) = log(t)\" = function(t) log(t)\n    )#end switch\n  })#end l_\n  \n  #calculate lambda over time\n  l_values <- reactive({\n    l_function <- l_calculation()\n    l_function(t_intervals())\n  })\n  \n  #instance lambda\n  l_instance <- reactive({\n    l_function <- l_calculation()\n    l_function(t_instance())\n  })\n  \n  p_dist <- reactive({\n    p_x <- dpois(seq(0,10),lambda = l_instance())\n    p_x\n  })\n  \n  # Outputs -----------------------------------------------------------------\n  \n  output$t_instance_ui <- renderUI({\n    \n    sliderInput(\"t_instance\",\n                \"Select a Time Instance\",\n                min = 1,\n                max = input$t_max,\n                value = 1,\n                step = 1)\n    \n  })\n  \n  output$l_fun_hc <- renderHighchart({\n    hc <- highchart() %>%\n      hc_xAxis(plotLines = list(\n                list(\n                  label = list(text = paste0(c(\"Lambda: \", round(l_instance(),digits = 2)),collapse=\"\")),\n                  color = \"#FF0000\",\n                  width = 2,\n                  value = t_instance()\n                 ) \n                )\n               ) %>%\n      hc_add_series(name = 'Lambda', \n                    data = l_values(),\n                    marker=list(enabled=F)) %>%\n      hc_title(text = \"Lambda as a Function of Time\",\n               align = 'left') %>%\n      hc_exporting(enabled = T) %>%\n      hc_add_theme(hc_theme_tufte())\n  })\n  \n  output$p_dist_instance_hc <- renderHighchart({\n    hc <- highchart() %>%\n      hc_xAxis(seq(0,10)) %>%\n      hc_add_series(name = \"P(X = x)\", \n                    data = p_dist(), \n                    marker=list(enabled=F),\n                    type = \"area\") %>%\n      hc_yAxis(min = 0, max = 0.5) %>%\n      hc_title(text = \"Poisson Distribution\",align = \"left\") %>%\n      hc_add_theme(hc_theme_tufte())# %>%\n      # hc_chart(\n      #   type = \"spline\"\n      # )\n      # \n    \n  })\n  \n})\n\n\n",
    "created" : 1509565936400.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2595574931",
    "id" : "7A1DC54C",
    "lastKnownWriteTime" : 1510678104,
    "last_content_update" : 1510678104798,
    "path" : "//my.files.iastate.edu/Users/cmgrimm/Desktop/GitHub/IE513_Project/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}